import{p as z,b as L,a as _,j as r,r as E}from"./index-D2DBufRw.js";import{P as I}from"./PageHeader-DwjN8_2N.js";import{X as M,at as O,Y as v,a0 as R,a3 as P,Z as A,$ as c,a6 as x,a4 as F,a5 as B,a8 as W,au as H,w as C,an as w,aq as m,ap as Z,ai as D,ar as q,as as S}from"./App-Bk8TEhFC.js";import{r as Q}from"./mgt-spinner-CVbNZbev.js";import{r as G,M as U}from"./mgt-people-C9OZsAJD.js";import{G as j}from"./get-zTOGGR46.js";import"./repeat-DCnvCPfQ.js";import"./mgt-get-Cdt1YcCD.js";const V=[M`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size, 24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size, 12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size, 20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size, 12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(255,255,255)!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:rgb(0,0,0)!important}}
`];var N=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function d(l){try{u(n.next(l))}catch(f){a(f)}}function y(l){try{u(n.throw(l))}catch(f){a(f)}}function u(l){l.done?o(l.value):i(l.value).then(d,y)}u((n=n.apply(s,e||[])).next())})};const k=(s,e,t)=>N(void 0,void 0,void 0,function*(){const n=s.api(e).middlewareOptions(z(t)).orderby("start/dateTime");return O.create(s,n)}),Y=(s,e,t,n)=>N(void 0,void 0,void 0,function*(){const i=`startdatetime=${e.toISOString()}`,o=`enddatetime=${t.toISOString()}`,a=n?`groups/${n}/calendar/calendarview?${i}&${o}`:`me/calendarview?${i}&${o}`;return k(s,a,n?["Group.Read.All","Group.ReadWrite.All"]:["Calendars.ReadBasic","Calendars.Read","Calendars.ReadWrite"])});var g=function(s,e,t,n){var i=arguments.length,o=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(s,e,t,n);else for(var d=s.length-1;d>=0;d--)(a=s[d])&&(o=(i<3?a(o):i>3?a(e,t,o):a(e,t))||o);return i>3&&o&&Object.defineProperty(e,t,o),o},h=function(s,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,e)},b=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function d(l){try{u(n.next(l))}catch(f){a(f)}}function y(l){try{u(n.throw(l))}catch(f){a(f)}}function u(l){l.done?o(l.value):i(l.value).then(d,y)}u((n=n.apply(s,e||[])).next())})};const X=()=>{R(H),G(),P("agenda",p)};class p extends A{constructor(){super(...arguments),this.days=3,this.renderContent=()=>{if(!this.events||this.events.length===0)return this.renderNoData();const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;const n={agenda:!0,grouped:this.groupByDay};return c`
      <div dir=${this.direction} class="${x(n)}">
        ${this.groupByDay?this.renderGroups(e):this.renderEvents(e)}
      </div>
    `},this.renderLoading=()=>this.renderTemplate("loading",null)||c`
        <fluent-card class="event event-loading">
          <div class="event-time-container">
            <div class="event-time-loading loading-element"></div>
          </div>
          <div class="event-details-container">
            <div class="event-subject-loading loading-element"></div>
            <div class="event-location-container">
              <div class="event-location-icon-loading loading-element"></div>
              <div class="event-location-loading loading-element"></div>
            </div>
            <div class="event-location-container">
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
              <div class="event-attendee-loading loading-element"></div>
            </div>
          </div>
        </fluent-card>`,this.onResize=()=>{this._isNarrow=this.offsetWidth<600}}static get styles(){return V}static get requiredScopes(){return[...new Set(["calendars.read",...U.requiredScopes])]}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}reload(){return b(this,void 0,void 0,function*(){this.events=yield this.loadEvents()})}clearState(){this.events=null}renderNoData(){return this.renderTemplate("no-data",null)||c``}renderEvent(e){this._isNarrow=this.offsetWidth<600;const t={narrow:this._isNarrow};return c`
      <fluent-card class="${x(Object.assign({event:!0},t))}">
        <div class="${x(Object.assign({"event-time-container":!0},t))}">
          <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div>
        </div>
        <div class="${x(Object.assign({"event-details-container":!0},t))}">
          ${this.renderTitle(e)} ${this.renderLocation(e)} ${this.renderAttendees(e)}
        </div>
        <div class="event-other-container">${this.renderOther(e)}</div>
      </fluent-card>
    `}renderHeader(e){return this.renderTemplate("header",{header:e},"header-"+e)||c`
        <div class="header" aria-label="${e}">${e}</div>
      `}renderTitle(e){return c`
      <div
        aria-label=${e.subject}
        class="${x({"event-subject":!0,narrow:this._isNarrow})}"
      >
        ${e.subject}
      </div>`}renderLocation(e){return e.location.displayName?c`
      <div class="event-location-container">
        <div class="event-location-icon">${F(B.OfficeLocation)}</div>
        <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div>
      </div>
    `:null}renderAttendees(e){return e.attendees.length?W`
      <mgt-people
        show-max="5"
        show-presence
        class="event-attendees"
        .peopleQueries=${e.attendees.map(t=>t.emailAddress.address)}
      ></mgt-people>
    `:null}renderOther(e){return this.hasTemplate("event-other")?c`
          ${this.renderTemplate("event-other",{event:e},e.id+"-other")}
        `:null}renderGroups(e){const t={};return e.forEach(n=>{var i;let o=(i=n==null?void 0:n.start)===null||i===void 0?void 0:i.dateTime;n.end.timeZone==="UTC"&&(o+="Z");const a=this.getDateHeaderFromDateTimeString(o);t[a]=t[a]||[],t[a].push(n)}),c`
      ${Object.keys(t).map(n=>c`
            <div class="group">${this.renderHeader(n)} ${this.renderEvents(t[n])}</div>
          `)}
    `}renderEvents(e){return c`
        ${e.map(t=>c`
              <div
                class="event-container"
                tabindex="0"
                @focus=${()=>this.eventClicked(t)}>
                ${this.renderTemplate("event",{event:t},t.id)||this.renderEvent(t)}
              </div>`)}`}args(){return[this.providerState,this.preferredTimezone,this.eventQuery,this.date,this.groupId,this.days]}loadState(){return b(this,void 0,void 0,function*(){if(this.events)return;const e=yield this.loadEvents();(e==null?void 0:e.length)>0&&(this.events=e)})}eventClicked(e){this.fireCustomEvent("eventClick",e)}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";let t=e.start.dateTime;e.start.timeZone==="UTC"&&(t+="Z");let n=e.end.dateTime;e.end.timeZone==="UTC"&&(n+="Z");const i=this.prettyPrintTimeFromDateTime(new Date(t)),o=this.prettyPrintTimeFromDateTime(new Date(n));return`${i} - ${o}`}loadEvents(){return b(this,void 0,void 0,function*(){const e=L.globalProvider;let t=[];if((e==null?void 0:e.state)===_.SignedIn){const n=e.graph.forComponent(this);if(this.eventQuery)try{const i=this.eventQuery.split("|");let o,a;i.length>1?(a=i[0].trim(),o=i[1].trim()):a=this.eventQuery;const d=yield k(n,a,o?[o]:[]);if(d!=null&&d.value)for(t=d.value;d.hasNext;)yield d.next(),t=d.value}catch{}else{const i=this.date?new Date(this.date):new Date,o=new Date(i.getTime());o.setDate(i.getDate()+this.days);try{const a=yield Y(n,i,o,this.groupId);if(a!=null&&a.value)for(t=a.value;a.hasNext;)yield a.next(),t=a.value}catch{}}}return t})}prettyPrintTimeFromDateTime(e){return e.toLocaleTimeString(navigator.language,{timeStyle:"short",timeZone:this.preferredTimezone})}getDateHeaderFromDateTimeString(e){return new Date(e).toLocaleDateString(navigator.language,{dateStyle:"full",timeZone:this.preferredTimezone})}}g([v({attribute:"date",type:String}),h("design:type",String)],p.prototype,"date",void 0);g([v({attribute:"group-id",type:String}),h("design:type",String)],p.prototype,"groupId",void 0);g([v({attribute:"days",type:Number}),h("design:type",Object)],p.prototype,"days",void 0);g([v({attribute:"event-query",type:String}),h("design:type",String)],p.prototype,"eventQuery",void 0);g([v({attribute:"events",type:Array,hasChanged:(s,e)=>s!==e}),h("design:type",Array)],p.prototype,"events",void 0);g([v({attribute:"show-max",type:Number}),h("design:type",Number)],p.prototype,"showMax",void 0);g([v({attribute:"group-by-day",type:Boolean}),h("design:type",Boolean)],p.prototype,"groupByDay",void 0);g([v({attribute:"preferred-timezone",type:String}),h("design:type",String)],p.prototype,"preferredTimezone",void 0);g([v({attribute:!1}),h("design:type",Boolean)],p.prototype,"_isNarrow",void 0);const J=C("agenda",X),K=C("spinner",Q),ee=w({email:{boxShadow:"var(--box-shadow)",...m.padding("10px"),...m.margin("8px"),":hover":{borderLeftWidth:"4px",borderLeftColor:"var(--input-border-color--hover)",borderLeftStyle:"solid",paddingLeft:"6px"},"& mgt-person":{"--font-size":"12px","--person-avatar-size":"16px"}},link:{color:"var(--color-sub1)",textDecorationLine:"none"},header:{display:"flex",justifyContent:"space-between"},subject:{color:"var(--color-sub1)",fontSize:"14px",...m.gridArea("1 / 1 / auto / 3"),...m.margin("0")},title:{display:"flex",justifyContent:"space-between",marginBottom:"4px",color:"var(--color-sub1)"},date:{fontSize:"12px",paddingLeft:"4px",float:"right"},body:{fontSize:"13px",textOverflow:"ellipsis",wordWrap:"break-word",...m.overflow("hidden"),maxHeight:"2.8em",lineHeight:"1.4em",color:"var(--color-sub2)"},emptyBody:{fontStyle:"italic"}});function T(s){var n,i;const e=ee(),t=s.dataContext;return r.jsx("div",{className:e.email,children:r.jsxs("a",{className:e.link,href:t.webLink,target:"_blank",rel:"noreferrer",children:[r.jsx("div",{className:e.header,children:r.jsx("div",{children:r.jsx(Z,{personQuery:(i=(n=t.sender)==null?void 0:n.emailAddress)==null?void 0:i.address,personCardInteraction:"hover",view:"oneline"})})}),r.jsxs("div",{className:e.title,children:[r.jsx("h3",{className:e.subject,children:t.subject}),r.jsx("span",{className:e.date,children:new Date(t.receivedDateTime).toLocaleDateString()})]}),t!=null&&t.bodyPreview?r.jsx("div",{className:e.body,children:t.bodyPreview}):r.jsx("div",{className:D(e.body,e.emptyBody),children:"..."})]})})}const te=w({root:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 300px)"},message:{paddingLeft:"10px"}}),$=s=>{const e=te();return r.jsxs("div",{className:e.root,children:[r.jsx(K,{}),r.jsx("div",{className:e.message,children:r.jsx("span",{children:s.message||"Loading..."})})]})},ne=w({container:{display:"flex",flexDirection:"row"},panels:{...m.padding("10px")},main:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"70%"},side:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"30%"}}),pe=()=>{const s=ne(),[e,t]=E.useState("focused"),n=(i,o)=>{t(o.value)};return r.jsxs(r.Fragment,{children:[r.jsx(I,{title:"Mail and Calendar",description:"Stay productive and navigate your emails and your calendar appointments"}),r.jsxs(q,{selectedValue:e,onTabSelect:n,className:s.container,children:[r.jsx(S,{value:"focused",children:"Focused"}),r.jsx(S,{value:"others",children:"Others"})]}),r.jsxs("div",{className:s.container,children:[r.jsxs("div",{className:D(s.panels,s.main),children:[e==="focused"&&r.jsxs(j,{resource:"/me/mailFolders/Inbox/messages?$orderby=InferenceClassification, createdDateTime DESC&filter=InferenceClassification eq 'Focused'",maxPages:3,scopes:["Mail.Read"],children:[r.jsx(T,{template:"value"}),r.jsx($,{template:"loading",message:"Loading your focused inbox..."})]}),e==="others"&&r.jsxs(j,{resource:"/me/mailFolders/Inbox/messages?$orderby=InferenceClassification, createdDateTime DESC&filter=InferenceClassification eq 'Other'",maxPages:3,scopes:["Mail.Read"],children:[r.jsx(T,{template:"value"}),r.jsx($,{template:"loading",message:"Loading your other inbox..."})]})]}),r.jsx("div",{className:s.side,children:r.jsx(J,{groupByDay:!0})})]})]})};export{pe as default};
