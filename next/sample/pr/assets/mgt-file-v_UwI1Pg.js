import{X as b,a3 as x,Z as P,$ as p,a4 as S,a5 as w,dj as D,dk as T,dl as _,dm as $,dn as z,dp as k,dq as M,dr as B,ds as F,dt as j,du as O,dv as C,dw as U,dx as R,aQ as N,cF as Q,Y as d,d0 as L}from"./App-Bk8TEhFC.js";import{b as E,a as I}from"./index-D2DBufRw.js";const W=[b`
:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size, 14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\e70d"}.ms-icon-chevron-up::before{content:"\\\e70e"}.ms-icon-contact::before{content:"\\\e77b"}.ms-icon-add-friend::before{content:"\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\eb6d"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size, var(--last-modified-font-size, 12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size, var(--size-font-size, 12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}
`],v={PowerPoint:"pptx",Word:"docx",Excel:"xlsx",Pdf:"pdf",OneNote:"onetoc",OneNotePage:"one",InfoPath:"xsn",Visio:"vstx",Publisher:"pub",Project:"mpp",Access:"accdb",Mail:"email",Csv:"csv",Archive:"archive",Xps:"vector",Audio:"audio",Video:"video",Image:"photo",Web:"html",Text:"txt",Xml:"xml",Story:"genericfile",ExternalContent:"genericfile",Folder:"folder",Spsite:"spo",Other:"genericfile"},y="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types",V=(r,i,t)=>{const e=v[r]||"genericfile";return`${y}/${i.toString()}/${e}.${t}`},q=(r,i,t)=>Object.keys(v).find(s=>v[s]===r)?`${y}/${i.toString()}/${r}.${t}`:r==="jpg"||r==="png"?(r="photo",`${y}/${i.toString()}/${r}.${t}`):null,A={modifiedSubtitle:"Modified",sizeSubtitle:"Size"};var l=function(r,i,t,e){var s=arguments.length,o=s<3?i:e===null?e=Object.getOwnPropertyDescriptor(i,t):e,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(r,i,t,e);else for(var f=r.length-1;f>=0;f--)(h=r[f])&&(o=(s<3?h(o):s>3?h(i,t,o):h(i,t))||o);return s>3&&o&&Object.defineProperty(i,t,o),o},a=function(r,i){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,i)},X=function(r,i,t,e){function s(o){return o instanceof t?o:new t(function(h){h(o)})}return new(t||(t=Promise))(function(o,h){function f(c){try{u(e.next(c))}catch(m){h(m)}}function g(c){try{u(e.throw(c))}catch(m){h(m)}}function u(c){c.done?o(c.value):s(c.value).then(f,g)}u((e=e.apply(r,i||[])).next())})};const Y=()=>x("file",n);class n extends P{static get styles(){return W}get strings(){return A}static get requiredScopes(){return[...new Set(["files.read","files.read.all","sites.read.all"])]}args(){return[this.providerState,this.fileQuery,this.siteId,this.itemId,this.driveId,this.itemPath,this.listId,this.groupId,this.userId,this.insightType,this.insightId,this.fileDetails,this.fileIcon]}constructor(){super(),this.renderContent=()=>{if(!this.driveItem)return this.renderNoData();const i=this.driveItem;let t;if(t=this.renderTemplate("default",{file:i}),!t){const e=this.renderDetails(i),s=this.renderFileTypeIcon();t=p`
        <div class="item">
          ${s} ${e}
        </div>`}return t},this.line1Property="name",this.line2Property="lastModifiedDateTime",this.line3Property="size",this.view="threelines"}renderNoData(){return this.renderTemplate("no-data",null)||p``}renderFileTypeIcon(){if(!this.fileIcon&&!this.driveItem.name)return p``;let i,t="";if(this.fileIcon)i=this.fileIcon;else{const e=/(?:\.([^.]+))?$/;t=this.driveItem.package===void 0&&this.driveItem.folder===void 0?e.exec(this.driveItem.name)[1]?e.exec(this.driveItem.name)[1].toLowerCase():this.driveItem.size?"null":"folder":this.driveItem.package!==void 0&&this.driveItem.package.type==="oneNote"?"onetoc":"folder",i=q(t,48,"svg")}return p`
      <div class="item__file-type-icon">
        ${i?p`
              <img src=${i} alt="${t.toUpperCase()} File icon" />
            `:p`
              ${S(w.File)}
            `}
      </div>
    `}renderDetails(i){if(!i||this.view==="image")return p``;const t=[];if(this.view>"image"){const e=this.getTextFromProperty(i,this.line1Property);e&&t.push(p`
          <div class="line1" aria-label="${e}">${e}</div>
        `)}if(this.view>"oneline"){const e=this.getTextFromProperty(i,this.line2Property);e&&t.push(p`
          <div class="line2" aria-label="${e}">${e}</div>
        `)}if(this.view>"twolines"){const e=this.getTextFromProperty(i,this.line3Property);e&&t.push(p`
          <div class="line3" aria-label="${e}">${e}</div>
        `)}return p`
      <div class="item__details">
        ${t}
      </div>
    `}loadState(){return X(this,void 0,void 0,function*(){if(this.fileDetails){this.driveItem=this.fileDetails;return}const i=E.globalProvider;if(!i||i.state===I.Loading)return;if(i.state===I.SignedOut){this.driveItem=null;return}const t=i.graph.forComponent(this);let e;const s=!this.driveId&&!this.siteId&&!this.groupId&&!this.listId&&!this.userId;this.driveId&&!this.itemId&&!this.itemPath||this.siteId&&!this.itemId&&!this.itemPath||this.groupId&&!this.itemId&&!this.itemPath||this.listId&&!this.siteId&&!this.itemId||this.insightType&&!this.insightId||this.userId&&!this.itemId&&!this.itemPath&&!this.insightType&&!this.insightId?e=null:this.fileQuery?e=yield D(t,this.fileQuery):this.itemId&&s?e=yield T(t,this.itemId):this.itemPath&&s?e=yield _(t,this.itemPath):this.userId?this.itemId?e=yield $(t,this.userId,this.itemId):this.itemPath?e=yield z(t,this.userId,this.itemPath):this.insightType&&this.insightId&&(e=yield k(t,this.userId,this.insightType,this.insightId)):this.driveId?this.itemId?e=yield M(t,this.driveId,this.itemId):this.itemPath&&(e=yield B(t,this.driveId,this.itemPath)):this.siteId&&!this.listId?this.itemId?e=yield F(t,this.siteId,this.itemId):this.itemPath&&(e=yield j(t,this.siteId,this.itemPath)):this.listId?e=yield O(t,this.siteId,this.listId,this.itemId):this.groupId?this.itemId?e=yield C(t,this.groupId,this.itemId):this.itemPath&&(e=yield U(t,this.groupId,this.itemPath)):this.insightType&&!this.userId&&(e=yield R(t,this.insightType,this.insightId)),this.driveItem=e})}getTextFromProperty(i,t){if(!t||t.length===0)return null;const e=t.trim().split(",");let s,o=0;for(;!s&&o<e.length;){const h=e[o].trim();switch(h){case"size":{let f="0";i.size&&(f=Q(i.size)),s=`${this.strings.sizeSubtitle}: ${f}`;break}case"lastModifiedDateTime":{let f,g;if(i.lastModifiedDateTime){const u=new Date(i.lastModifiedDateTime);f=N(u),g=`${this.strings.modifiedSubtitle} ${f}`}else g="";s=g;break}default:s=i[h]}o++}return s}}l([d({attribute:"file-query"}),a("design:type",String)],n.prototype,"fileQuery",void 0);l([d({attribute:"site-id"}),a("design:type",String)],n.prototype,"siteId",void 0);l([d({attribute:"drive-id"}),a("design:type",String)],n.prototype,"driveId",void 0);l([d({attribute:"group-id"}),a("design:type",String)],n.prototype,"groupId",void 0);l([d({attribute:"list-id"}),a("design:type",String)],n.prototype,"listId",void 0);l([d({attribute:"user-id"}),a("design:type",String)],n.prototype,"userId",void 0);l([d({attribute:"item-id"}),a("design:type",String)],n.prototype,"itemId",void 0);l([d({attribute:"item-path"}),a("design:type",String)],n.prototype,"itemPath",void 0);l([d({attribute:"insight-type"}),a("design:type",String)],n.prototype,"insightType",void 0);l([d({attribute:"insight-id"}),a("design:type",String)],n.prototype,"insightId",void 0);l([d({type:Object}),a("design:type",Object)],n.prototype,"fileDetails",void 0);l([d({attribute:"file-icon"}),a("design:type",String)],n.prototype,"fileIcon",void 0);l([d({type:Object}),a("design:type",Object)],n.prototype,"driveItem",void 0);l([d({attribute:"line1-property"}),a("design:type",String)],n.prototype,"line1Property",void 0);l([d({attribute:"line2-property"}),a("design:type",String)],n.prototype,"line2Property",void 0);l([d({attribute:"line3-property"}),a("design:type",String)],n.prototype,"line3Property",void 0);l([d({attribute:"view",converter:r=>L(r,"threelines")}),a("design:type",String)],n.prototype,"view",void 0);export{n as M,V as g,Y as r};
